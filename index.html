<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Buzzer Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            width: 90%;
            max-width: 800px;
        }

        .login-screen, .role-selection, .team-selection, .host-dashboard, .player-interface, .setup-screen {
            display: none;
            text-align: center;
        }

        .login-screen.active, .role-selection.active, .team-selection.active, 
        .host-dashboard.active, .player-interface.active, .setup-screen.active {
            display: block;
        }

        h1, h2 {
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .input-group {
            margin-bottom: 1rem;
        }

        input[type="text"], input[type="password"], input[type="number"] {
            width: 100%;
            max-width: 300px;
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            backdrop-filter: blur(5px);
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn-team-a {
            background: linear-gradient(45deg, #4834d4, #686de0);
        }

        .btn-team-b {
            background: linear-gradient(45deg, #eb4d4b, #c0392b);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #30336b, #130f40);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .buzzer-btn {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            font-size: 24px;
            font-weight: bold;
            margin: 20px auto;
            display: block;
            transition: all 0.3s ease;
        }

        .buzzer-btn:hover:not(:disabled) {
            transform: scale(1.1);
        }

        .buzzer-btn:active:not(:disabled) {
            transform: scale(0.95);
        }

        .team-info {
            display: flex;
            justify-content: space-around;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .team-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 10px;
            margin: 10px;
            min-width: 200px;
        }

        .status-panel {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
        }

        .winner-display {
            font-size: 2rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .member-list {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 10px;
            margin-top: 10px;
        }

        .error-message {
            color: #ff6b6b;
            margin-top: 10px;
            font-weight: bold;
        }

        .success-message {
            color: #2ecc71;
            margin-top: 10px;
            font-weight: bold;
        }

        .host-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .game-id-display {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            font-family: monospace;
            font-size: 1.2rem;
            letter-spacing: 2px;
        }

        .connection-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
        }

        .connected {
            background: #2ecc71;
        }

        .disconnected {
            background: #e74c3c;
        }

        @media (max-width: 768px) {
            .container {
                width: 95%;
                padding: 1rem;
            }
            
            .buzzer-btn {
                width: 150px;
                height: 150px;
                font-size: 18px;
            }
            
            .team-info {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="connection-status" id="connectionStatus">Connecting...</div>

    <div class="container">
        <!-- Setup Screen -->
        <div class="setup-screen active" id="setupScreen">
            <h1>🎯 Quiz Buzzer Game</h1>
            <h2>Game Setup</h2>
            
            <div class="input-group">
                <input type="text" id="gameIdInput" placeholder="Enter Game ID (or leave blank for new game)" maxlength="6">
            </div>
            
            <button class="btn" onclick="createOrJoinGame()">Start Game</button>
            
            <div class="status-panel">
                <p>🎮 <strong>How to play:</strong></p>
                <p>• Host creates a game and gets a Game ID</p>
                <p>• Players enter the same Game ID to join</p>
                <p>• Up to 30 players per team (A & B)</p>
                <p>• Host controls the buzzer, first press wins!</p>
            </div>
            
            <div class="error-message" id="setupError"></div>
        </div>

        <!-- Role Selection -->
        <div class="role-selection" id="roleSelection">
            <h1>🎯 Quiz Buzzer Game</h1>
            <div class="game-id-display">Game ID: <span id="displayGameId"></span></div>
            <h2>Select Your Role</h2>
            <button class="btn" onclick="showHostLogin()">I'm the Host</button>
            <button class="btn btn-secondary" onclick="showTeamSelection()">I'm a Player</button>
        </div>

        <!-- Host Login -->
        <div class="login-screen" id="loginScreen">
            <h1>🎯 Quiz Buzzer Game</h1>
            <div class="game-id-display">Game ID: <span id="hostGameId"></span></div>
            <h2>Host Login</h2>
            <div class="input-group">
                <input type="text" id="hostUsername" placeholder="Username" required>
            </div>
            <div class="input-group">
                <input type="password" id="hostPassword" placeholder="Password" required>
            </div>
            <button class="btn" onclick="hostLogin()">Login as Host</button>
            <button class="btn btn-secondary" onclick="showRoleSelection()">Back</button>
            <div class="error-message" id="loginError"></div>
        </div>

        <!-- Team Selection -->
        <div class="team-selection" id="teamSelection">
            <h1>🎯 Join the Game</h1>
            <div class="game-id-display">Game ID: <span id="teamGameId"></span></div>
            <div class="input-group">
                <input type="text" id="playerName" placeholder="Enter your name" required>
            </div>
            <h2>Choose Your Team</h2>
            <button class="btn btn-team-a" onclick="joinTeam('A')">Join Team A (<span id="previewTeamACount">0</span>/30)</button>
            <button class="btn btn-team-b" onclick="joinTeam('B')">Join Team B (<span id="previewTeamBCount">0</span>/30)</button>
            <button class="btn btn-secondary" onclick="showRoleSelection()">Back</button>
            <div class="error-message" id="teamError"></div>
        </div>

        <!-- Host Dashboard -->
        <div class="host-dashboard" id="hostDashboard">
            <h1>🎯 Host Dashboard</h1>
            <div class="game-id-display">Game ID: <span id="dashboardGameId"></span></div>
            
            <div class="status-panel">
                <h3>Game Status: <span id="gameStatus">Waiting to Start</span></h3>
                <div id="winnerDisplay" class="winner-display" style="display: none;"></div>
            </div>

            <div class="host-controls">
                <button class="btn" id="enableBuzzer" onclick="enableBuzzer()">Enable Buzzer</button>
                <button class="btn btn-secondary" id="disableBuzzer" onclick="disableBuzzer()" disabled>Disable Buzzer</button>
                <button class="btn" onclick="resetRound()">Reset Round</button>
                <button class="btn" onclick="clearAllPlayers()">Clear All Players</button>
            </div>

            <div class="team-info">
                <div class="team-card">
                    <h3 style="color: #4834d4;">Team A</h3>
                    <p>Members: <span id="teamACount">0</span></p>
                    <div class="member-list" id="teamAMembers"></div>
                </div>
                <div class="team-card">
                    <h3 style="color: #eb4d4b;">Team B</h3>
                    <p>Members: <span id="teamBCount">0</span></p>
                    <div class="member-list" id="teamBMembers"></div>
                </div>
            </div>

            <button class="btn btn-secondary" onclick="endGame()">End Game</button>
        </div>

        <!-- Player Interface -->
        <div class="player-interface" id="playerInterface">
            <h1>🎯 Quiz Buzzer</h1>
            <div class="game-id-display">Game ID: <span id="playerGameId"></span></div>
            <h2>Welcome, <span id="playerDisplayName"></span>!</h2>
            <h3>Team <span id="playerTeam"></span></h3>
            
            <div class="status-panel">
                <p id="buzzerStatus">Waiting for host to enable buzzer...</p>
            </div>

            <button class="buzzer-btn btn" id="buzzerButton" onclick="pressBuzzer()" disabled>
                🔔 BUZZ!
            </button>

            <div class="team-info">
                <div class="team-card">
                    <h3 style="color: #4834d4;">Team A: <span id="playerTeamACount">0</span> members</h3>
                </div>
                <div class="team-card">
                    <h3 style="color: #eb4d4b;">Team B: <span id="playerTeamBCount">0</span> members</h3>
                </div>
            </div>

            <button class="btn btn-secondary" onclick="leaveGame()">Leave Game</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getDatabase, ref, set, push, onValue, off, remove, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js';

        // Firebase configuration (using demo project - replace with your own)
        const firebaseConfig = {
            apiKey: "AIzaSyBYqF5S7XK1GZzqMvt3CgdXYvZ3RWzm9D0",
            authDomain: "quiz-buzzer-demo.firebaseapp.com",
            databaseURL: "https://quiz-buzzer-demo-default-rtdb.firebaseio.com/",
            projectId: "quiz-buzzer-demo",
            storageBucket: "quiz-buzzer-demo.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef123456789"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        
        // Make Firebase available globally
        window.database = database;
        window.firebaseRefs = { ref, set, push, onValue, off, remove, serverTimestamp };

        // Initialize the game
        window.initGame();
    </script>

    <script>
        // Game State
        let gameState = {
            gameId: '',
            isHost: false,
            playerName: '',
            playerTeam: '',
            playerId: '',
            buzzerEnabled: false,
            buzzerPressed: false,
            winner: null,
            teams: {
                A: {},
                B: {}
            },
            connected: false
        };

        // Host credentials
        const HOST_CREDENTIALS = {
            username: 'host',
            password: 'quiz123'
        };

        let gameRef = null;

        // Initialize
        function initGame() {
            updateConnectionStatus(false);
            showScreen('setupScreen');
        }

        // Make initGame available globally
        window.initGame = initGame;

        // Generate random game ID
        function generateGameId() {
            return Math.random().toString(36).substr(2, 6).toUpperCase();
        }

        // Create or join game
        function createOrJoinGame() {
            const gameIdInput = document.getElementById('gameIdInput').value.trim().toUpperCase();
            const errorDiv = document.getElementById('setupError');
            
            if (gameIdInput && gameIdInput.length !== 6) {
                errorDiv.textContent = 'Game ID must be exactly 6 characters';
                return;
            }

            const gameId = gameIdInput || generateGameId();
            gameState.gameId = gameId;
            
            // Set up Firebase reference
            gameRef = window.firebaseRefs.ref(window.database, `games/${gameId}`);
            
            if (!gameIdInput) {
                // Creating new game
                initializeNewGame(gameId);
            } else {
                // Joining existing game
                joinExistingGame(gameId);
            }
        }

        // Initialize new game
        function initializeNewGame(gameId) {
            const initialData = {
                createdAt: window.firebaseRefs.serverTimestamp(),
                buzzerEnabled: false,
                buzzerPressed: false,
                winner: null,
                teams: {
                    A: {},
                    B: {}
                }
            };

            window.firebaseRefs.set(gameRef, initialData)
                .then(() => {
                    setupGameListeners();
                    showRoleSelection();
                })
                .catch((error) => {
                    document.getElementById('setupError').textContent = 'Failed to create game. Please try again.';
                    console.error('Error creating game:', error);
                });
        }

        // Join existing game
        function joinExistingGame(gameId) {
            window.firebaseRefs.onValue(gameRef, (snapshot) => {
                if (snapshot.exists()) {
                    setupGameListeners();
                    showRoleSelection();
                } else {
                    document.getElementById('setupError').textContent = 'Game not found. Please check the Game ID.';
                }
            }, { onlyOnce: true });
        }

        // Setup Firebase listeners
        function setupGameListeners() {
            window.firebaseRefs.onValue(gameRef, (snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    updateGameState(data);
                    updateConnectionStatus(true);
                } else if (gameState.connected) {
                    // Game was deleted
                    alert('Game has ended.');
                    resetToSetup();
                }
            });

            gameState.connected = true;
        }

        // Update game state from Firebase
        function updateGameState(data) {
            gameState.buzzerEnabled = data.buzzerEnabled || false;
            gameState.buzzerPressed = data.buzzerPressed || false;
            gameState.winner = data.winner || null;
            gameState.teams = data.teams || { A: {}, B: {} };
            
            updateDisplay();
        }

        // Navigation functions
        function showScreen(screenId) {
            document.querySelectorAll('.setup-screen, .login-screen, .role-selection, .team-selection, .host-dashboard, .player-interface')
                .forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function showRoleSelection() {
            document.getElementById('displayGameId').textContent = gameState.gameId;
            showScreen('roleSelection');
            updateTeamPreview();
        }

        function showHostLogin() {
            document.getElementById('hostGameId').textContent = gameState.gameId;
            showScreen('loginScreen');
        }

        function showTeamSelection() {
            document.getElementById('teamGameId').textContent = gameState.gameId;
            showScreen('teamSelection');
            updateTeamPreview();
        }

        // Host functions
        function hostLogin() {
            const username = document.getElementById('hostUsername').value;
            const password = document.getElementById('hostPassword').value;
            const errorDiv = document.getElementById('loginError');

            if (username === HOST_CREDENTIALS.username && password === HOST_CREDENTIALS.password) {
                gameState.isHost = true;
                document.getElementById('dashboardGameId').textContent = gameState.gameId;
                showScreen('hostDashboard');
                updateDisplay();
                errorDiv.textContent = '';
            } else {
                errorDiv.textContent = 'Invalid credentials. Use username: "host", password: "quiz123"';
            }
        }

        function enableBuzzer() {
            const updates = {
                buzzerEnabled: true,
                buzzerPressed: false,
                winner: null
            };

            // Reset all players' hasPressed status
            Object.keys(gameState.teams.A).forEach(playerId => {
                updates[`teams/A/${playerId}/hasPressed`] = false;
            });
            Object.keys(gameState.teams.B).forEach(playerId => {
                updates[`teams/B/${playerId}/hasPressed`] = false;
            });

            window.firebaseRefs.set(gameRef, { ...gameState, ...updates });
        }

        function disableBuzzer() {
            window.firebaseRefs.set(window.firebaseRefs.ref(window.database, `games/${gameState.gameId}/buzzerEnabled`), false);
        }

        function resetRound() {
            const updates = {
                buzzerEnabled: false,
                buzzerPressed: false,
                winner: null
            };

            // Reset all players' hasPressed status
            Object.keys(gameState.teams.A).forEach(playerId => {
                updates[`teams/A/${playerId}/hasPressed`] = false;
            });
            Object.keys(gameState.teams.B).forEach(playerId => {
                updates[`teams/B/${playerId}/hasPressed`] = false;
            });

            window.firebaseRefs.set(gameRef, { ...gameState, ...updates });
        }

        function clearAllPlayers() {
            const updates = {
                teams: { A: {}, B: {} },
                buzzerEnabled: false,
                buzzerPressed: false,
                winner: null
            };
            window.firebaseRefs.set(gameRef, { ...gameState, ...updates });
        }

        function endGame() {
            if (confirm('Are you sure you want to end the game? This will remove all players.')) {
                window.firebaseRefs.remove(gameRef);
                resetToSetup();
            }
        }

        // Player functions
        function joinTeam(team) {
            const playerName = document.getElementById('playerName').value.trim();
            const errorDiv = document.getElementById('teamError');

            if (!playerName) {
                errorDiv.textContent = 'Please enter your name';
                return;
            }

            const teamPlayers = gameState.teams[team] || {};
            if (Object.keys(teamPlayers).length >= 30) {
                errorDiv.textContent = `Team ${team} is full (30 members maximum)`;
                return;
            }

            // Check if name already exists
            const allPlayers = { ...gameState.teams.A, ...gameState.teams.B };
            const nameExists = Object.values(allPlayers).some(player => player.name === playerName);
            if (nameExists) {
                errorDiv.textContent = 'Name already taken. Please choose a different name.';
                return;
            }

            gameState.playerName = playerName;
            gameState.playerTeam = team;
            gameState.playerId = generatePlayerId();

            // Add player to Firebase
            const playerData = {
                name: playerName,
                hasPressed: false,
                joinedAt: window.firebaseRefs.serverTimestamp()
            };

            const playerRef = window.firebaseRefs.ref(window.database, `games/${gameState.gameId}/teams/${team}/${gameState.playerId}`);
            window.firebaseRefs.set(playerRef, playerData)
                .then(() => {
                    document.getElementById('playerDisplayName').textContent = playerName;
                    document.getElementById('playerTeam').textContent = team;
                    document.getElementById('playerGameId').textContent = gameState.gameId;
                    showScreen('playerInterface');
                    updateDisplay();
                })
                .catch((error) => {
                    errorDiv.textContent = 'Failed to join team. Please try again.';
                    console.error('Error joining team:', error);
                });
        }

        function pressBuzzer() {
            if (!gameState.buzzerEnabled || gameState.buzzerPressed) {
                return;
            }

            const timestamp = new Date().toISOString();
            const winnerData = {
                team: gameState.playerTeam,
                player: gameState.playerName,
                playerId: gameState.playerId,
                timestamp: timestamp
            };

            // Update Firebase with winner and disable buzzer
            const updates = {
                buzzerPressed: true,
                buzzerEnabled: false,
                winner: winnerData,
                [`teams/${gameState.playerTeam}/${gameState.playerId}/hasPressed`]: true
            };

            const gameRef = window.firebaseRefs.ref(window.database, `games/${gameState.gameId}`);
            window.firebaseRefs.set(gameRef, { ...gameState, ...updates });
        }

        function leaveGame() {
            if (gameState.playerId && gameState.playerTeam) {
                const playerRef = window.firebaseRefs.ref(window.database, `games/${gameState.gameId}/teams/${gameState.playerTeam}/${gameState.playerId}`);
                window.firebaseRefs.remove(playerRef);
            }
            
            resetToSetup();
        }

        // Utility functions
        function generatePlayerId() {
            return 'player_' + Math.random().toString(36).substr(2, 9);
        }

        function resetToSetup() {
            if (gameRef) {
                window.firebaseRefs.off(gameRef);
            }
            
            gameState = {
                gameId: '',
                isHost: false,
                playerName: '',
                playerTeam: '',
                playerId: '',
                buzzerEnabled: false,
                buzzerPressed: false,
                winner: null,
                teams: { A: {}, B: {} },
                connected: false
            };
            
            document.getElementById('gameIdInput').value = '';
            document.getElementById('hostUsername').value = '';
            document.getElementById('hostPassword').value = '';
            document.getElementById('playerName').value = '';
            
            updateConnectionStatus(false);
            showScreen('setupScreen');
        }

        function updateConnectionStatus(connected) {
            const statusDiv = document.getElementById('connectionStatus');
            gameState.connected = connected;
            
            if (connected) {
                statusDiv.textContent = 'Connected';
                statusDiv.className = 'connection-status connected';
            } else {
                statusDiv.textContent = 'Disconnected';
                statusDiv.className = 'connection-status disconnected';
            }
        }

        function updateTeamPreview() {
            const teamACount = Object.keys(gameState.teams.A || {}).length;
            const teamBCount = Object.keys(gameState.teams.B || {}).length;
            
            document.getElementById('previewTeamACount').textContent = teamACount;
            document.getElementById('previewTeamBCount').textContent = teamBCount;
        }

        // Update display functions
        function updateDisplay() {
            if (gameState.isHost) {
                updateHostDashboard();
            } else if (gameState.playerName) {
                updatePlayerInterface();
            }
            updateTeamPreview();
        }

        function updateHostDashboard() {
            const teamACount = Object.keys(gameState.teams.A || {}).length;
            const teamBCount = Object.keys(gameState.teams.B || {}).length;
            
            document.getElementById('teamACount').textContent = teamACount;
            document.getElementById('teamBCount').textContent = teamBCount;

            // Update member lists
            const teamAMembers = Object.values(gameState.teams.A || {});
            const teamBMembers = Object.values(gameState.teams.B || {});
            
            document.getElementById('teamAMembers').innerHTML = teamAMembers
                .map(player => `<div>${player.name}${player.hasPressed ? ' ✅' : ''}</div>`).join('');
            document.getElementById('teamBMembers').innerHTML = teamBMembers
                .map(player => `<div>${player.name}${player.hasPressed ? ' ✅' : ''}</div>`).join('');

            // Update controls
            document.getElementById('enableBuzzer').disabled = gameState.buzzerEnabled;
            document.getElementById('disableBuzzer').disabled = !gameState.buzzerEnabled;

            // Update status
            let status = 'Waiting to Start';
            if (gameState.winner) {
                status = 'Round Complete';
            } else if (gameState.buzzerEnabled) {
                status = 'Buzzer Active - Waiting for buzz!';
            } else if (gameState.buzzerPressed) {
                status = 'Buzzer Disabled';
            }
            document.getElementById('gameStatus').textContent = status;

            // Update winner display
            const winnerDiv = document.getElementById('winnerDisplay');
            if (gameState.winner) {
                const timestamp = new Date(gameState.winner.timestamp).toLocaleTimeString();
                winnerDiv.innerHTML = `🏆 Team ${gameState.winner.team} wins!<br>${gameState.winner.player} pressed first at ${timestamp}`;
                winnerDiv.style.display = 'block';
            } else {
                winnerDiv.style.display = 'none';
            }
        }

        function updatePlayerInterface() {
            const buzzerButton = document.getElementById('buzzerButton');
            const statusDiv = document.getElementById('buzzerStatus');
            const currentPlayer = gameState.teams[gameState.playerTeam]?.[gameState.playerId];

            const teamACount = Object.keys(gameState.teams.A || {}).length;
            const teamBCount = Object.keys(gameState.teams.B || {}).length;
            document.getElementById('playerTeamACount').textContent = teamACount;
            document.getElementById('playerTeamBCount').textContent = teamBCount;

            if (gameState.winner) {
                if (gameState.winner.playerId === gameState.playerId) {
                    statusDiv.textContent = '🎉 You pressed first! Congratulations!';
                    buzzerButton.style.background = 'linear-gradient(45deg, #2ecc71, #27ae60)';
                } else {
                    const timestamp = new Date(gameState.winner.timestamp).toLocaleTimeString();
                    statusDiv.textContent = `${gameState.winner.player} from Team ${gameState.winner.team} pressed first at ${timestamp}!`;
                }
                buzzerButton.disabled = true;
            } else if (currentPlayer && currentPlayer.hasPressed) {
                statusDiv.textContent = 'You have already pressed the buzzer this round!';
                buzzerButton.disabled = true;
                buzzerButton.style.background = 'linear-gradient(45deg, #95a5a6, #7f8c8d)';
            } else if (gameState.buzzerEnabled) {
                statusDiv.textContent = 'Buzzer is ACTIVE! Press to buzz!';
                buzzerButton.disabled = false;
                buzzerButton.style.background = gameState.playerTeam === 'A' ? 
                    'linear-gradient(45deg, #4834d4, #686de0)' : 'linear-gradient(45deg, #eb4d4b, #c0392b)';
            } else {
                statusDiv.textContent = 'Waiting for host to enable buzzer...';
                buzzerButton.disabled = true;
                buzzerButton.style.background = 'linear-gradient(45deg, #95a5a6, #7f8c8d)';
            }
        }

        // Make functions available globally
        window.createOrJoinGame = createOrJoinGame;
        window.showRoleSelection = showRoleSelection;
        window.showHostLogin = showHostLogin;
        window.showTeamSelection = showTeamSelection;
        window.hostLogin = hostLogin;
        window.enableBuzzer = enableBuzzer;
        window.disableBuzzer = disableBuzzer;
        window.resetRound = resetRound;
        window.clearAllPlayers = clearAllPlayers;
        window.endGame = endGame;
        window.joinTeam = joinTeam;
        window.pressBuzzer = pressBuzzer;
        window.leaveGame = leaveGame;
    </script>
</body>
</html>